<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Encrypt Article for IPFS | Rosebud World</title>
  <link rel="stylesheet" href="style.css">
  <!-- Include OpenPGP.js from a CDN -->
  <script src="https://unpkg.com/openpgp@5.5.0/dist/openpgp.min.js"></script>
  <style>
    /* Basic inline styling for the encryption tool page */
    body {
      font-family: sans-serif;
      margin: 20px;
      background: #fdfdfd;
    }
    header, main, footer {
      max-width: 800px;
      margin: 0 auto;
    }
    header h1 {
      text-align: center;
    }
    nav {
      text-align: center;
      margin-bottom: 20px;
    }
    nav a {
      margin: 0 10px;
      text-decoration: none;
      color: #007bff;
    }
    section {
      margin-bottom: 30px;
    }
    #status {
      margin-top: 10px;
      font-weight: bold;
      color: #555;
    }
  </style>
</head>
<body>
  <header>
    <h1>Encrypt Your Article for IPFS</h1>
    <nav>
      <a href="index.html">Home</a> |
      <a href="articles.html">Articles</a> |
      <a href="guidelines.html">Guidelines</a> |
      <a href="encrypt.html">Encrypt</a> |
      <a href="submit.html">Submit</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Instructions</h2>
      <p>
        If you wish to protect your article before submitting it to our platform, use this tool to encrypt your file using our public key.
      </p>
      <ol>
        <li>Select the file you wish to encrypt (plain text, HTML, or Markdown).</li>
        <li>Click the "Encrypt and Download" button.</li>
        <li>The encrypted file will be downloaded with the extension <code>.pgp</code>. You can then upload this file to IPFS.</li>
      </ol>
    </section>

    <section>
      <h2>Encrypt Your File</h2>
      <input type="file" id="fileInput" accept=".txt,.html,.md" />
      <button id="encryptButton">Encrypt and Download</button>
      <div id="status"></div>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Rosebud World</p>
  </footer>

  <script>
    const publicKeyArmored = `-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=NonR
-----END PGP PUBLIC KEY BLOCK-----`;

    const fileInput = document.getElementById('fileInput');
    const encryptButton = document.getElementById('encryptButton');
    const statusDiv = document.getElementById('status');

    encryptButton.addEventListener('click', async () => {
      // Ensure a file is selected.
      if (!fileInput.files || fileInput.files.length === 0) {
        statusDiv.textContent = 'Please select a file to encrypt.';
        return;
      }

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async (e) => {
        const fileContent = e.target.result;
        try {
          statusDiv.textContent = 'Encrypting... Please wait.';
          
          // Read the provided public key.
          const publicKey = await openpgp.readKey({ armoredKey: publicKeyArmored });
          
          // Create a message from the file content.
          const message = await openpgp.createMessage({ text: fileContent });
          
          // Encrypt the message using the public key.
          const encrypted = await openpgp.encrypt({
            message: message,
            encryptionKeys: publicKey,
            format: 'armored'
          });
          
          // Create a Blob from the encrypted text.
          const blob = new Blob([encrypted], { type: 'text/plain' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = file.name + '.pgp';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
          statusDiv.textContent = 'Encryption complete! Your encrypted file has been downloaded.';
        } catch (err) {
          console.error(err);
          statusDiv.textContent = 'Encryption failed. Check the console for details.';
        }
      };

      reader.onerror = () => {
        statusDiv.textContent = 'Error reading the file.';
      };

      // Read the file as text.
      reader.readAsText(file);
    });
  </script>
</body>
</html>
